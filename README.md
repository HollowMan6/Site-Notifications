# æµè§ˆå™¨æ¨é€ç½‘ç«™é€šçŸ¥

[![last-commit](https://img.shields.io/github/last-commit/HollowMan6/Site-Notifications)](https://github.com/HollowMan6/Site-Notifications/graphs/commit-activity)
![Python package](https://github.com/HollowMan6/Site-Notifications/workflows/Python%20package/badge.svg)
[![Node.js Package](https://github.com/HollowMan6/Site-Notifications/actions/workflows/npm-publish.yml/badge.svg)](https://github.com/HollowMan6/Site-Notifications/actions/workflows/npm-publish.yml)
[![Push Browser Notification and Daily Weather Report](https://github.com/HollowMan6/Site-Notifications/actions/workflows/notification.yml/badge.svg)](https://github.com/HollowMan6/Site-Notifications/actions/workflows/notification.yml)

[![Followers](https://img.shields.io/github/followers/HollowMan6?style=social)](https://github.com/HollowMan6?tab=followers)
[![watchers](https://img.shields.io/github/watchers/HollowMan6/Site-Notifications?style=social)](https://github.com/HollowMan6/Site-Notifications/watchers)
[![stars](https://img.shields.io/github/stars/HollowMan6/Site-Notifications?style=social)](https://github.com/HollowMan6/Site-Notifications/stargazers)
[![forks](https://img.shields.io/github/forks/HollowMan6/Site-Notifications?style=social)](https://github.com/HollowMan6/Site-Notifications/network/members)

[![Open Source Love](https://img.shields.io/badge/-%E2%9D%A4%20Open%20Source-Green?style=flat-square&logo=Github&logoColor=white&link=https://hollowman6.github.io/fund.html)](https://hollowman6.github.io/fund.html)
[![GPL Licence](https://img.shields.io/badge/license-GPL-blue)](https://opensource.org/licenses/GPL-3.0/)
[![Repo-Size](https://img.shields.io/github/repo-size/HollowMan6/Site-Notifications.svg)](https://github.com/HollowMan6/Site-Notifications/archive/main.zip)

[![Total alerts](https://img.shields.io/lgtm/alerts/g/HollowMan6/Site-Notifications.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/HollowMan6/Site-Notifications/alerts/)
[![Language grade: Python](https://img.shields.io/lgtm/grade/python/g/HollowMan6/Site-Notifications.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/HollowMan6/Site-Notifications/context:python)
[![Language grade: JavaScript](https://img.shields.io/lgtm/grade/javascript/g/HollowMan6/Site-Notifications.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/HollowMan6/Site-Notifications/context:javascript)

(English version is down below)

[Python/NodeJSåº“ä¾èµ–](https://github.com/HollowMan6/Site-Notifications/network/dependencies)

[æ¨é€è„šæœ¬(python)](python/webpush.py) [æ¨é€è„šæœ¬(NodeJS)](src/webpush.js)

[è®¢é˜…ç½‘é¡µç«¯](index.html)

## ç®€ä»‹

[æ¨é€è„šæœ¬(python)](python/webpush.py)å‚æ•°è§ï¼šhttps://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/showNotification#parameters

å…¶ä¸­å‡½æ•°æ ‡é¢˜Titleä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼ŒOptionsä¸ºå­—å…¸ç±»å‹ï¼Œä½¿ç”¨æ—¶éœ€è¦é¢„å…ˆè®¾å®šç¯å¢ƒå˜é‡`SUBSINFO`ä¸ºè®¢é˜…ç ã€‚

é€šè¿‡[è¿™é‡Œçš„è®¢é˜…ç½‘é¡µç«¯](https://hollowman.ml/Site-Notifications/)ä½ å¯ä»¥è®¢é˜…[æˆ‘çš„ç½‘ç«™](https://hollowman.ml/)çš„æµè§ˆå™¨æ¨é€æ¶ˆæ¯ï¼Œè·å–åˆ°è®¢é˜…ç ã€‚éšåä½ å°±å¯ä»¥ä½¿ç”¨è®¢é˜…ç å°†æ¶ˆæ¯é€šè¿‡æµè§ˆå™¨é€šçŸ¥çš„å½¢å¼æ¨é€åˆ°å®‰å“/Linux/Windows/Macç­‰é€šçŸ¥æ å¤„(IOSæš‚ä¸æ”¯æŒ)ã€‚å³ä½¿ä½ å…³é—­äº†ç½‘é¡µï¼Œä½ ä»ç„¶å¯ä»¥æ”¶åˆ°é€šçŸ¥ã€‚

å¦‚æœä½ éœ€è¦ä»ä½ è‡ªå·±çš„æœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™é‡Œçš„[æ¨é€å·¥å…·åº“](https://github.com/web-push-libs)

## ç½‘ç«™ä½¿ç”¨çš„ VAPID Keys

å…¬é’¥: `BOHSZycLLiXBjp0djrpD6vbzVX4g7D1QcW4cb1UonDcDYu6ewOXJ4qcz-e3J3d2VpjHgm0tHnZRjoGTv7SRJl7M`

ç§é’¥: `tUCZ-8DGMlUhr3ntyN4PQoDbALJSBnv8yZXhi4XX1iI`

## æ³¨æ„

å»ºè®®é€‰ç”¨æœ€æ–°ç‰ˆè°·æ­ŒChromeã€å¾®è½¯Edgeã€Mozilla Firefoxã€‚

è¯·ä¸è¦å‘Šè¯‰åˆ«äººä½ çš„è®¢é˜…ç ï¼Œä»¥é˜²è¢«éªšæ‰°ã€‚å¦å¤–ä½ éšæ—¶å¯ä»¥é€šè¿‡æŒ‰é’®å…³é—­å¼€å¯æµè§ˆå™¨æ¨é€æ¥é‡æ–°ç”Ÿæˆè®¢é˜…ç ã€‚

ç”±äºå®‰å“ç«¯Chromeã€Edgeã€Firefoxæµè§ˆå™¨è®¢é˜…å’Œæ¥æ”¶æ‰“å¡æ¶ˆæ¯æ—¶ä½¿ç”¨FCM(Firebase Cloud Messaging)ï¼Œæ‰€ä»¥è¯·ç¡®ä¿è®¾å¤‡è®¿é—®è°·æ­ŒæœåŠ¡é€šç•…ï¼Œå¹¶ä¸”é€šå¸¸éœ€è¦å®‰è£…å¥½ç›¸å…³è°·æ­ŒæœåŠ¡æ‰èƒ½ä½¿ç”¨ã€‚å¦‚ç‚¹å‡»`Enable Push Message`åï¼Œå‡ºç°é”™è¯¯`DOMException: Registration failed - push service error`ï¼Œåˆ™é™¤äº†ç½‘ç»œé—®é¢˜ï¼Œè¯·ç¡®ä¿æµè§ˆå™¨ä¸ºè°·æ­ŒPlayå•†åº—ä¸‹è½½çš„æœ€æ–°ç‰ˆï¼Œå…¶å®ƒåŸå› ä¸€èˆ¬ä¸ºä½ çš„ROMç‰ˆæœ¬ä¸æ”¯æŒFCMæ¨é€æœåŠ¡ï¼Œå»ºè®®å®‰è£…è°·æ­Œæ¡†æ¶æˆ–è€…åˆ·å›½é™…ç‰ˆROMä¹‹åå†è¯•ã€‚

åä¸º/è£è€€æ‰‹æœºå¦‚æœå®‰è£…äº†è°·æ­Œæ¡†æ¶åè¿˜ä¸æ”¯æŒFCMæ¨é€æœåŠ¡å¯ä»¥å‚è€ƒ[è¿™ç¯‡æ–‡ç« ](docs/Huawei_Honor_FCM_Fix)

## åº”ç”¨: æ¯æ—¥å¤©æ°”é¢„æŠ¥æ¨é€

[æ¯æ—¥å¤©æ°”é¢„æŠ¥æ¨é€å·¥ä½œæµ](.github/workflows/weatherreport.yml)

è¿™é‡Œä½¿ç”¨GitHub Actionsï¼Œæ¯æ—¥ä¸­åˆ12ç‚¹è‡ªåŠ¨è¿è¡Œ[è„šæœ¬](python/weather.py)ï¼Œæ¨é€å½“æ—¥å¤©æ°”ã€‚

å¦‚æœä½ ä¹Ÿæƒ³ä½¿ç”¨ï¼Œè¯·åœ¨Forkæœ¬ä»“åº“ä¹‹åï¼Œåˆ›å»ºä¸¤ä¸ªActions Secretsï¼Œä¸€ä¸ªNameä¸º`LOCATION`ï¼Œvalueä¸ºå¤©æ°”é¢„æŠ¥åœ°ç‚¹ï¼›å¦ä¸€ä¸ªNameä¸º`SUBSINFO`ï¼Œvalueä¸ºä½ çš„è®¢é˜…ç ã€‚

## Github Actions Workflow è‡ªè¡Œé…ç½®å·¥ä½œæµ

ä½ å¯ä»¥è‡ªè¡Œåˆ›å»ºä¸€ä¸ªä»“åº“å¹¶è‡ªè¡Œé…ç½®å·¥ä½œæµè¿›è¡Œä½¿ç”¨ï¼Œè¯¥å·¥ä½œæµå¯ä»¥è‡ªè¡Œå®šä¹‰æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå¤©æ°”é¢„æŠ¥æ¨é€ã€‚[ç¤ºä¾‹å·¥ä½œæµæ–‡ä»¶](.github/workflows/notification.yml)

### è¾“å…¥

#### å¿…é¡»

* SUBSINFO: ä½ çš„ç½‘ç«™è®¢é˜…ç 

#### å¯é€‰

* LOCATION: å¤©æ°”é¢„æŠ¥åœ°ç‚¹(è¯¥è¾“å…¥æ ‡å¿—å·¥ä½œæµè¿›è¡Œå¤©æ°”é¢„æŠ¥æŠ¥é“)
* TITLE: é€šçŸ¥æ ‡é¢˜(è¯¥è¾“å…¥æ ‡å¿—å·¥ä½œæµè¿›è¡Œè‡ªå®šä¹‰é€šçŸ¥æ¨é€)
* OPTIONS: é€šçŸ¥é€‰é¡¹(è¯¥è¾“å…¥ä»…å¯¹è‡ªå®šä¹‰é€šçŸ¥æ¨é€èµ·æ•ˆ)

### ç¤ºä¾‹

```yaml
- name: Push Browser Notification and Daily Weather Report
  uses: HollowMan6/Site-Notifications@main
  with:
    SUBSINFO: ${{ secrets.SUBSINFO }}
    LOCATION: ${{ secrets.LOCATION }}
    TITLE: ${{ secrets.TITLE }}
    OPTIONS: ${{ secrets.OPTIONS }}
```

# Browser Website Notification

[Python / NodeJS library dependency](https://github.com/HollowMan6/Site-Notifications/network/dependencies)

[Web push Script(python)](python/webpush.py) [Web push Script(NodeJS)](src/webpush.js)

[Subscription Page](index.html)

## Introduction

See https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/showNotification#parameters for [Web push Script(python)](python/webpush.py) Parameters.

The function's title being the string type, options being dictionary type. You have to pre-set environment variable `SUBSINFO` as the Subscription Code.

Through the [subscription page](https://hollowman.ml/Site-Notifications/) you can subscribe to [my website](https://hollowman.ml/)'s notification, then use the Subscription Code to directly push the message to the Notifications of Android, Linux, Windows, Mac, and etc. (IOS not supported currently) through your browser's Site Notifications. Even if you close this website, you can still receive notifications you sent.

To send push messages from your own server, use one of the [web push libraries](https://github.com/web-push-libs) available.

## VAPID Keys for this website

Public: `BOHSZycLLiXBjp0djrpD6vbzVX4g7D1QcW4cb1UonDcDYu6ewOXJ4qcz-e3J3d2VpjHgm0tHnZRjoGTv7SRJl7M`

Private: `tUCZ-8DGMlUhr3ntyN4PQoDbALJSBnv8yZXhi4XX1iI`

## Note

It is recommended to select the latest version of Google Chrome, Microsoft edge and Mozilla Firefox.

For Users in ğŸ‡¨ğŸ‡³ Mainland China, because the Chrome, Edge and Firefox for Android browsers uses FCM (firebase Cloud Messaging) to push, you usually need to make sure you can visit Google Service, install relevant Google services before you can use it. For example, after clicking `Enable Push Message`, when the error `DOMException: Registration failed - push service error` occurs, except from network problems, please make sure you download latest version from Google Play Store, otherwise generally it's caused by your ROM version not supporting FCM push service. It is recommended to install Google framework or use the Global ROM version and try again.

If your phone is Huawei or Honor phone and does not support FCM push service after installing Google framework (GMS), please refer to [this video (in Bahasa Indonesia but can just follow gesture)](https://www.youtube.com/watch?v=nLzYrxm0mMg).

## Application: Daily Weather Report

[Daily Weather Report Workflow](.github/workflows/weatherreport.yml)

Here use GitHub Actions, executing [script](python/weather.py) 12 a.m. CST everyday to push Weather Report Notification.

If you also want to use it, please create two Actions Secrets after forking. One name is `LOCATION`, and value is the weather forecasting location; the other name is `SUBSINFO`, and value is your subscription code.

## Github Actions Workflow Self-Configure Workflow

You can create your own repository and configure your own workflow to use, this workflow can send customized notifications and also weather report. [Example Workflow YAML File](.github/workflows/notification.yml)

### Input

#### Required

* SUBSINFO: Your Website Subscription Code

#### Optional

* LOCATION: Weather Forecast Location (This input marks push Weather Forecast Notification)
* TITLE: Notification Title (This input marks push Customized Notification)
* OPTIONS: Notification Options (This input only works for Customized Notification)

### Example

```yaml
- name: Push Browser Notification and Daily Weather Report
  uses: HollowMan6/Site-Notifications@main
  with:
    SUBSINFO: ${{ secrets.SUBSINFO }}
    LOCATION: ${{ secrets.LOCATION }}
    TITLE: ${{ secrets.TITLE }}
    OPTIONS: ${{ secrets.OPTIONS }}
```
